<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>勇者ハーレム - ノベルビューア（編集モード）</title>
  <style>
    html, body { margin: 0; padding: 0; height: 100%; background: #000; color: #fff; font-family: sans-serif; overflow: hidden; }
    #header { height: 48px; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: space-between; padding: 0 12px; }
    #novel-container { position: relative; height: calc(100% - 48px); }
    #background { position: absolute; width: 100%; height: 100%; background-size: cover; background-position: center; z-index: 0; }
    #character { position: absolute; bottom: -10%; left: 50%; transform: translateX(-50%); height: 70%; z-index: 1; transition: filter 0.3s ease; }
    #character.dimmed { filter: brightness(40%) saturate(50%); }
    #dialogue-box { position: absolute; bottom: 0; width: 100%; height: 25%; background: rgba(0, 0, 0, 0.6); padding: 16px; z-index: 2; transition: height 0.3s ease; overflow: hidden; }
    #dialogue-box.expanded { height: 80%; overflow-y: auto; }
    #speaker { font-weight: bold; }
    #text { margin-top: 8px; line-height: 1.6; }
    #edit-form { display: none; }
    #dialogue-box.expanded #edit-form { display: block; margin-top: 12px; }
    label { display: block; margin-top: 8px; }
    select, textarea, input { width: 100%; margin-top: 4px; font-size: 14px; }
    button { margin-top: 12px; padding: 6px 12px; background: #333; color: #fff; border: none; cursor: pointer; }
    #close-log { display: none; position: absolute; top: 8px; right: 12px; font-size: 20px; cursor: pointer; z-index: 3; }
    #dialogue-box.expanded #close-log { display: block; }

    #modal {
      display: none; position: fixed; z-index: 10;
      left: 0; top: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.7); justify-content: center; align-items: center;
    }
    #modal-content {
      background: #222; padding: 20px; border-radius: 8px; width: 90%; max-width: 400px;
    }
    #modal-close {
      position: absolute; top: 10px; right: 20px; font-size: 24px; cursor: pointer;
    }
  </style>
</head>
<body>
<div id="header">
  <div id="scene-title">第1話</div>
  <div id="controls">
    <button onclick="openModal()">⚙️ 設定</button>
  </div>
</div>
<div id="novel-container">
  <div id="background"><img id="character" src="" alt="" /></div>
  <div id="dialogue-box">
    <div id="speaker"></div>
    <div id="text"></div>
    <div id="edit-form">
      <label>話者：<select id="edit-speaker"></select></label>
      <label>セリフ：<textarea id="edit-text" rows="2"></textarea></label>
      <label>表情：<select id="edit-face"></select></label>
      <label>背景：<select id="edit-bg"></select></label>
      <label>特殊：<input type="text" id="edit-special" /></label>
      <button onclick="applyEdits()">✅ 適用</button>
    </div>
    <div id="close-log" onclick="collapseLog()">✕</div>
  </div>
</div>
<div id="modal">
  <div id="modal-content">
    <div id="modal-close" onclick="closeModal()">✕</div>
    <h2>設定メニュー</h2>
    <button onclick="saveProgress()">💾 進行状況を保存</button><br><br>
    <button onclick="loadProgress()">📂 続きから再開</button><br><br>
    <button onclick="toggleVoice()">🔊 読み上げ: <span id="voice-status">オフ</span></button><br><br>
    <button onclick="downloadScenes()">⬇️ scenes.json を保存</button><br><br>
    <a href="assets_editor.html" target="_blank">🖼️ アセット管理ページを開く</a>
  </div>
</div>
<script>
  // ここにスクリプトが続きます（既存の JS を維持）
</script>
</body>
</html>
